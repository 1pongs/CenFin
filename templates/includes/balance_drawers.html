{% load humanize %}
<div class="offcanvas offcanvas-end drawer-short" tabindex="-1" id="accountsDrawer" aria-labelledby="accountsDrawerLabel" data-bs-scroll="true" data-bs-backdrop="false">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="accountsDrawerLabel">Accounts</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <ul class="list-group list-group-flush">
      {% for acc in account_balances %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ acc.account_name }}
          <span class="badge bg-primary rounded-pill">₱{{ acc.balance|floatformat:2|intcomma }}</span>
        </li>
      {% empty %}
        <li class="list-group-item">No accounts found.</li>
      {% endfor %}
    </ul>
  </div>
</div>

<div class="offcanvas offcanvas-start drawer-short" tabindex="-1" id="entitiesDrawer" aria-labelledby="entitiesDrawerLabel" data-bs-scroll="true" data-bs-backdrop="false">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="entitiesDrawerLabel">Entities</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <ul class="list-group list-group-flush">
      {% for ent in entity_balances %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          {{ ent.entity_name }}
          <span class="badge bg-primary rounded-pill">₱{{ ent.balance|floatformat:2|intcomma }}</span>
        </li>
      {% empty %}
        <li class="list-group-item">No entities found.</li>
      {% endfor %}
    </ul>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const accountsDrawer = document.getElementById('accountsDrawer');
    const entitiesDrawer = document.getElementById('entitiesDrawer');
    const formContainer = document.getElementById('form-container');
    if (!formContainer) return;

    if (accountsDrawer) {
      accountsDrawer.addEventListener('shown.bs.offcanvas', () => {
        formContainer.classList.add('form-offset-right');
      });
      accountsDrawer.addEventListener('hidden.bs.offcanvas', () => {
        formContainer.classList.remove('form-offset-right');
      });
    }

    if (entitiesDrawer) {
      entitiesDrawer.addEventListener('shown.bs.offcanvas', () => {
        formContainer.classList.add('form-offset-left');
      });
      entitiesDrawer.addEventListener('hidden.bs.offcanvas', () => {
        formContainer.classList.remove('form-offset-left');
      });
    }
  });
</script>
